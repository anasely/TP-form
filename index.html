<!DOCTYPE html>
<html>
<head>
  <title>Affichage des données depuis Google Sheet</title>
</head>
<body>
  <div id="data-container"></div>
  <script>
    // Remplacez par l'URL de votre Google Sheet
    const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTBMKiNDRK0N4MoWCQa5oAsy9XW-WhVM4QYZB1mF3Cyn8xQtQpzW7DvRU0ljL3apr0ZaRSrrkCONskh/pub?output=csv';

    function getGoogleDriveFileID(url) {
      const match = url.match(/\/d\/([a-zA-Z0-9_-]+)(?:\/|$)/);
      return match ? match[1] : null;
    }

    // Fetch data from Google Sheet
    fetch(sheetURL)
      .then(response => response.text())
      .then(data => {
        // Split the data into rows
        const rows = data.split('\n');
        const container = document.getElementById('data-container');

        // Iterate through each row (excluding the header)
        for (let i = 1; i < rows.length; i++) {
          const columns = rows[i].split(',');

          // Assuming the columns are in this order: nom, prenom, photo, heure
          const Nom = columns[1];
          const mail = columns[2];
          const film = columns[3]
          const photo = columns[4]; // Lien vers la photo sur Google Drive

          // Skip the 'heure' column (columns[3])

          // Créez un élément d'image et définissez l'attribut 'src' sur le lien correct pour Google Drive
          const img = document.createElement('img');
          img.src = `https://drive.google.com/uc?export=view&id=${getGoogleDriveFileID(photo)}`;
          img.alt = 'Photos';


          // Afficher les données sur votre page web comme désiré
          const div = document.createElement('div');
          div.innerHTML = `Nom: ${Nom}<br>Email: ${mail}<br>Votre film prefere est: : ${film}<br> Photo: ${photo}<br>` ;
          div.appendChild(img); // Ajoutez l'image à la div
          container.appendChild(div);
        }
      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });

    // Fonction pour extraire l'ID du fichier Google Drive depuis le lien
    function getGoogleDriveFileID(url) {
      const match = url.match(/\/d\/([a-zA-Z0-9_-]+)(?:\/|$)/);
      return match ? match[1] : null;
    }
  </script>
</body>
</html>
