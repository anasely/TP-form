<!DOCTYPE html>
<html>
<head>
  <title>Affichage des données depuis Google Sheet</title>
</head>
<body>
  <div id="data-container"></div>
  <script>
    // Remplacez par l'URL de votre Google Sheet
    const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSn_9dh6hesCWnyc0qDh5oryYjwJq4PCOW6ZoavNxNh-a5em5lnMh5lpdqfAYld4rZPXGelzH32HieC/pub?output=csv';

    // Fonction pour convertir un lien Google Drive en un lien affichable
    

    // Fetch data from Google Sheet
    fetch(sheetURL)
      .then(response => response.text())
      .then(data => {
        // Split the data into rows
        const rows = data.split('\n');
        const container = document.getElementById('data-container');

        // Iterate through each row (excluding the header)
        for (let i = 1; i < rows.length; i++) {
          const columns = rows[i].split(',');

          // Assuming the columns are in this order: nom, prenom, photo, heure
          const Nom = columns[1];
          const prenom = columns[2];
          const photo = columns[3]; // Lien vers la photo sur Google Drive
           function convertDriveLink(link) {
      const fileID = link.match(/id=([a-zA-Z0-9_-]+)/);
      if (fileID) {
        return `https://drive.google.com/uc?export=view&id=${fileID[1]}`;
      }
      return ''; // Retourne une chaîne vide si le lien n'est pas valide
    }

          // Convertir le lien Google Drive en un lien affichable
          const photoLink = convertDriveLink(photo);

          // Créez un élément d'image et définissez l'attribut 'src' sur le lien correct
          const img = document.createElement('img');
          img.src = photoLink; // Utilisez le lien affichable
          img.alt = 'Photo';

          // Afficher les données sur votre page web comme désiré
          const div = document.createElement('div');
          div.innerHTML = `noms: ${Nom}<br>prenom: ${prenom}<br><br>prenom: ${photoLink}<br>` ;
          div.appendChild(img); // Ajoutez l'image à la div
          container.appendChild(div);
        }
      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });
  </script>
</body>
</html>
